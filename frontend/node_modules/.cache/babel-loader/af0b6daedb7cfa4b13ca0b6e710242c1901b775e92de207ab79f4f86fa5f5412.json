{"ast":null,"code":"//import router from '@/router';\nimport axios from 'axios';\nexport default {\n  name: 'ManageUsersComponent',\n  data() {\n    return {\n      emailID: '',\n      roleID: '',\n      myFile: '',\n      password: '',\n      username: '',\n      usernames: [],\n      user_id: null\n    };\n  },\n  methods: {\n    async onDelete(x) {\n      x.preventDefault();\n      // await axios\n      //   .get('/api/user')\n      //   .then((res) => {\n      //     let data = res.data.data;\n      //     this.usernames = data.map(({ user_name }) => user_name);\n      //     if (!this.usernames.includes(this.username)) {\n      //       alert(\"This username doesn't exist or is an admin/manager.\");\n      //       this.$router.go();\n      //     } else {\n      //       data.forEach((x) => {\n      //         if (x.user_name == this.username) {\n      //           this.user_id = x.user_id;\n      //           console.log(this.user_id);\n      //         }\n      //       });\n      //     }\n      //   })\n      //   .catch((err) => {\n      //     console.log(err);\n      //   });\n      await axios.delete(`/api/user/${this.username}`).then(res => {\n        console.log(res);\n        alert('User deleted successfully');\n        this.$router.go();\n      }).catch(err => {\n        console.log(err);\n      });\n    },\n    async addUser(x) {\n      // console.log(this.response)\n      x.preventDefault();\n      let thing = null;\n      if (this.roleID.toLowerCase() == 'student') {\n        thing = 1;\n      } else if (this.roleID.toLowerCase() == 'admin') {\n        thing = 3;\n      } else if (this.roleID.toLowerCase() == 'support agent') {\n        thing = 2;\n      } else if (this.roleID.toLowerCase() == 'manager') {\n        thing = 4;\n      } else {\n        alert('Please choose role amongst student/admin/manager/support agent!');\n        this.roleID = '';\n      }\n      if (this.roleID == '') {\n        location.reload();\n      } else {\n        console.log(this.emailID);\n        console.log(thing);\n        let c = this.emailID;\n        var data = {\n          email_id: c,\n          role_id: thing,\n          username: this.username,\n          password: this.password\n        };\n        console.log(c);\n        data = JSON.stringify(data);\n        console.log('Data is :');\n        console.log(data);\n        await axios.post('/api/user', {\n          data\n        }).then(res => {\n          if (res.status == 200) {\n            axios.post('/api/v1/discourse/create/user', {\n              data\n            }).then(res => {\n              console.log(res);\n            }).catch(err => console.log(err));\n          }\n          alert('User has been successfully added.');\n          this.$router.go();\n          console.log(res);\n        }).catch(err => {\n          console.log(err);\n        });\n      }\n    },\n    onUpload() {\n      this.myFile = this.$refs.file.files[0];\n    },\n    fileSubmission() {\n      let formData = new FormData();\n      console.log(this.myFile);\n      formData.append('file', this.myFile);\n      let authtoken = localStorage.getItem('token');\n      fetch('http://localhost:5000/api/importUsers', {\n        method: 'POST',\n        mode: 'cors',\n        cache: 'no-cache',\n        credentials: 'omit',\n        headers: {\n          secret_authtoken: authtoken\n          //'Content-Type': \"multipart/form-data\",\n        },\n\n        redirect: 'follow',\n        referrerPolicy: 'no-referrer',\n        body: formData\n      }).then(() => {\n        alert('User addition request has been received. You will get notified via email on the status.'); /*location.reload()*/\n      }).catch(e => console.log(e));\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","emailID","roleID","myFile","password","username","usernames","user_id","methods","onDelete","x","preventDefault","delete","then","res","console","log","alert","$router","go","catch","err","addUser","thing","toLowerCase","location","reload","c","email_id","role_id","JSON","stringify","post","status","onUpload","$refs","file","files","fileSubmission","formData","FormData","append","authtoken","localStorage","getItem","fetch","method","mode","cache","credentials","headers","secret_authtoken","redirect","referrerPolicy","body","e"],"sources":["C:\\Users\\mad946\\OneDrive - Sky\\Desktop\\IITM Docs\\SE Project - Files\\Milestone-6-SE\\frontend\\src\\components\\ManageUsersComponent.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"container\" style=\"margin-top: 20px\">\r\n      <p>\r\n        <button\r\n          class=\"btn btn-primary heading\"\r\n          type=\"button\"\r\n          data-bs-toggle=\"collapse\"\r\n          data-bs-target=\"#collapseExample\"\r\n          aria-expanded=\"false\"\r\n          aria-controls=\"collapseExample\"\r\n        >\r\n          ADD A USER BY EMAIL ID\r\n        </button>\r\n      </p>\r\n      <div class=\"collapse\" id=\"collapseExample\">\r\n        <div class=\"card card-body\">\r\n          <form v-on:submit=\"addUser\">\r\n            <div class=\"form-group\">\r\n              <label>Enter Email ID</label>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                v-model=\"emailID\"\r\n                required\r\n              />\r\n            </div>\r\n            <br />\r\n            <div class=\"form-group\">\r\n              <label>Enter Username</label>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                v-model=\"username\"\r\n                required\r\n              />\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label>Password</label>\r\n              <input\r\n                type=\"password\"\r\n                class=\"form-control\"\r\n                v-model=\"password\"\r\n                required\r\n              />\r\n            </div>\r\n            <br />\r\n            <div class=\"form-group\">\r\n              <label>Choose Role</label\r\n              ><select v-model=\"roleID\" class=\"form-select\">\r\n                <option value=\"student\">Student</option>\r\n                <option value=\"support agent\">Support Agent</option>\r\n                <option value=\"admin\">Admin</option>\r\n                <option value=\"manager\">Manager</option>\r\n              </select>\r\n            </div>\r\n            <button class=\"btn btn-primary\" type=\"submit\">Submit</button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <hr />\r\n    <div class=\"container\">\r\n      <p>\r\n        <button\r\n          class=\"btn btn-primary heading\"\r\n          type=\"button\"\r\n          data-bs-toggle=\"collapse\"\r\n          data-bs-target=\"#collapseExample2\"\r\n          aria-expanded=\"false\"\r\n          aria-controls=\"collapseExample\"\r\n        >\r\n          ADD MULTIPLE USERS BY CSV FILE\r\n        </button>\r\n      </p>\r\n      <div class=\"collapse\" id=\"collapseExample2\">\r\n        <div class=\"card card-body\">\r\n          <label> Please upload a CSV file if you wish to import data</label\r\n          ><br />\r\n          <div class=\"form-group\">\r\n            <input\r\n              class=\"btn btn-lg\"\r\n              ref=\"file\"\r\n              id=\"file\"\r\n              type=\"file\"\r\n              accept=\".csv\"\r\n              v-on:change=\"onUpload($event)\"\r\n            />\r\n          </div>\r\n          <div class=\"col-md-4\">\r\n            <button class=\"btn btn-primary\" @click=\"fileSubmission\">\r\n              Submit\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <hr />\r\n    <div class=\"container\">\r\n      <p>\r\n        <button\r\n          class=\"btn btn-primary heading\"\r\n          type=\"button\"\r\n          data-bs-toggle=\"collapse\"\r\n          data-bs-target=\"#collapseExample3\"\r\n          aria-expanded=\"false\"\r\n          aria-controls=\"collapseExample\"\r\n        >\r\n          DELETE USER BY USERNAME\r\n        </button>\r\n      </p>\r\n      <div class=\"collapse\" id=\"collapseExample3\">\r\n        <div class=\"card card-body\">\r\n          <div class=\"form-group\">\r\n            <label>Enter the username you wish to delete</label\r\n            ><input\r\n              type=\"text\"\r\n              class=\"form-control\"\r\n              v-model=\"username\"\r\n              required\r\n            />\r\n          </div>\r\n          <div class=\"col-md-4\">\r\n            <button class=\"btn btn-primary\" type=\"submit\" @click=\"onDelete\">\r\n              Delete\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n//import router from '@/router';\r\nimport axios from 'axios';\r\nexport default {\r\n  name: 'ManageUsersComponent',\r\n  data() {\r\n    return {\r\n      emailID: '',\r\n      roleID: '',\r\n      myFile: '',\r\n      password: '',\r\n      username: '',\r\n      usernames: [],\r\n      user_id: null,\r\n    };\r\n  },\r\n  methods: {\r\n    async onDelete(x) {\r\n      x.preventDefault();\r\n      // await axios\r\n      //   .get('/api/user')\r\n      //   .then((res) => {\r\n      //     let data = res.data.data;\r\n      //     this.usernames = data.map(({ user_name }) => user_name);\r\n      //     if (!this.usernames.includes(this.username)) {\r\n      //       alert(\"This username doesn't exist or is an admin/manager.\");\r\n      //       this.$router.go();\r\n      //     } else {\r\n      //       data.forEach((x) => {\r\n      //         if (x.user_name == this.username) {\r\n      //           this.user_id = x.user_id;\r\n      //           console.log(this.user_id);\r\n      //         }\r\n      //       });\r\n      //     }\r\n      //   })\r\n      //   .catch((err) => {\r\n      //     console.log(err);\r\n      //   });\r\n      await axios\r\n        .delete(`/api/user/${this.username}`)\r\n        .then((res) => {\r\n          console.log(res);\r\n          alert('User deleted successfully');\r\n          this.$router.go();\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    async addUser(x) {\r\n      // console.log(this.response)\r\n      x.preventDefault();\r\n      let thing = null;\r\n      if (this.roleID.toLowerCase() == 'student') {\r\n        thing = 1;\r\n      } else if (this.roleID.toLowerCase() == 'admin') {\r\n        thing = 3;\r\n      } else if (this.roleID.toLowerCase() == 'support agent') {\r\n        thing = 2;\r\n      } else if (this.roleID.toLowerCase() == 'manager') {\r\n        thing = 4;\r\n      } else {\r\n        alert(\r\n          'Please choose role amongst student/admin/manager/support agent!'\r\n        );\r\n        this.roleID = '';\r\n      }\r\n      if (this.roleID == '') {\r\n        location.reload();\r\n      } else {\r\n        console.log(this.emailID);\r\n        console.log(thing);\r\n        let c = this.emailID;\r\n        var data = {\r\n          email_id: c,\r\n          role_id: thing,\r\n          username: this.username,\r\n          password: this.password,\r\n        };\r\n        console.log(c);\r\n        data = JSON.stringify(data);\r\n        console.log('Data is :');\r\n        console.log(data);\r\n        await axios\r\n          .post('/api/user', {\r\n            data,\r\n          })\r\n          .then((res) => {\r\n            if (res.status == 200) {\r\n              axios\r\n                .post('/api/v1/discourse/create/user', { data })\r\n                .then((res) => {\r\n                  console.log(res);\r\n                })\r\n                .catch((err) => console.log(err));\r\n            }\r\n            alert('User has been successfully added.');\r\n            this.$router.go();\r\n            console.log(res);\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n      }\r\n    },\r\n    onUpload() {\r\n      this.myFile = this.$refs.file.files[0];\r\n    },\r\n    fileSubmission() {\r\n      let formData = new FormData();\r\n      console.log(this.myFile);\r\n      formData.append('file', this.myFile);\r\n\r\n      let authtoken = localStorage.getItem('token');\r\n      fetch('http://localhost:5000/api/importUsers', {\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        cache: 'no-cache',\r\n        credentials: 'omit',\r\n        headers: {\r\n          secret_authtoken: authtoken,\r\n          //'Content-Type': \"multipart/form-data\",\r\n        },\r\n        redirect: 'follow',\r\n        referrerPolicy: 'no-referrer',\r\n        body: formData,\r\n      })\r\n        .then(() => {\r\n          alert(\r\n            'User addition request has been received. You will get notified via email on the status.'\r\n          ); /*location.reload()*/\r\n        })\r\n        .catch((e) => console.log(e));\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.topic-container {\r\n  margin: 33px 63px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 1.5rem;\r\n}\r\n\r\n.heading {\r\n  background-color: white;\r\n  color: black;\r\n  font-size: 25px;\r\n}\r\n\r\n.heading:hover {\r\n  background-color: #f1f1f1;\r\n  color: black;\r\n  font-size: 20px;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}