{"ast":null,"code":"//import router from '@/router';\nimport axios from 'axios';\nexport default {\n  name: 'ManageUsersComponent',\n  data() {\n    return {\n      emailID: '',\n      roleID: '',\n      myFile: '',\n      username: '',\n      usernames: [],\n      user_id: null\n    };\n  },\n  methods: {\n    async onDelete(x) {\n      x.preventDefault();\n      await axios.get('/api/user').then(res => {\n        let data = res.data.data;\n        this.usernames = data.map(({\n          user_name\n        }) => user_name);\n        if (!this.usernames.includes(this.username)) {\n          alert(\"This username doesn't exist or is an admin/manager.\");\n          this.$router.go();\n        } else {\n          data.forEach(x => {\n            if (x.user_name == this.username) {\n              this.user_id = x.user_id;\n              console.log(this.user_id);\n            }\n          });\n        }\n      }).catch(err => {\n        console.log(err);\n      });\n      await axios.delete(`/api/user/${this.user_id}`).then(() => {\n        alert('User deleted successfully');\n        this.$router.go();\n      }).catch(err => {\n        console.log(err);\n      });\n    },\n    async addUser(x) {\n      // console.log(this.response)\n      x.preventDefault();\n      let thing = null;\n      if (this.roleID.toLowerCase() == 'student') {\n        thing = 1;\n      } else if (this.roleID.toLowerCase() == 'admin') {\n        thing = 3;\n      } else if (this.roleID.toLowerCase() == 'support agent') {\n        thing = 2;\n      } else if (this.roleID.toLowerCase() == 'manager') {\n        thing = 4;\n      } else {\n        alert('Please choose role amongst student/admin/manager/support agent!');\n        this.roleID = '';\n      }\n      if (this.roleID == '') {\n        location.reload();\n      } else {\n        console.log(this.emailID);\n        console.log(thing);\n        let c = this.emailID;\n        var data = {\n          email_id: c,\n          role_id: thing,\n          username: data.username\n        };\n        console.log(c);\n        data = JSON.stringify(data);\n        console.log('Data is :');\n        console.log(data);\n        await axios.post('/api/user', {\n          data\n        }).then(res => {\n          alert('User has been successfully added.');\n          //this.$router.go();\n          console.log(res);\n        }).catch(err => {\n          console.log(err);\n        });\n      }\n    },\n    onUpload() {\n      this.myFile = this.$refs.file.files[0];\n    },\n    fileSubmission() {\n      let formData = new FormData();\n      console.log(this.myFile);\n      formData.append('file', this.myFile);\n      let authtoken = localStorage.getItem('token');\n      fetch('http://localhost:5000/api/importUsers', {\n        method: 'POST',\n        mode: 'cors',\n        cache: 'no-cache',\n        credentials: 'omit',\n        headers: {\n          secret_authtoken: authtoken\n          //'Content-Type': \"multipart/form-data\",\n        },\n\n        redirect: 'follow',\n        referrerPolicy: 'no-referrer',\n        body: formData\n      }).then(() => {\n        alert('User addition request has been received. You will get notified via email on the status.'); /*location.reload()*/\n      }).catch(e => console.log(e));\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","emailID","roleID","myFile","username","usernames","user_id","methods","onDelete","x","preventDefault","get","then","res","map","user_name","includes","alert","$router","go","forEach","console","log","catch","err","delete","addUser","thing","toLowerCase","location","reload","c","email_id","role_id","JSON","stringify","post","onUpload","$refs","file","files","fileSubmission","formData","FormData","append","authtoken","localStorage","getItem","fetch","method","mode","cache","credentials","headers","secret_authtoken","redirect","referrerPolicy","body","e"],"sources":["C:\\Users\\mad946\\OneDrive - Sky\\Desktop\\IITM Docs\\SE Project - Files\\Milestone-6-SE\\frontend\\src\\components\\ManageUsersComponent.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"container\" style=\"margin-top: 20px\">\r\n      <p>\r\n        <button\r\n          class=\"btn btn-primary heading\"\r\n          type=\"button\"\r\n          data-bs-toggle=\"collapse\"\r\n          data-bs-target=\"#collapseExample\"\r\n          aria-expanded=\"false\"\r\n          aria-controls=\"collapseExample\"\r\n        >\r\n          ADD A USER BY EMAIL ID\r\n        </button>\r\n      </p>\r\n      <div class=\"collapse\" id=\"collapseExample\">\r\n        <div class=\"card card-body\">\r\n          <form v-on:submit=\"addUser\">\r\n            <div class=\"form-group\">\r\n              <label>Enter Email ID</label>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                v-model=\"emailID\"\r\n                required\r\n              />\r\n            </div>\r\n            <br />\r\n            <div class=\"form-group\">\r\n              <label>Enter Username</label>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                v-model=\"username\"\r\n                required\r\n              />\r\n            </div>\r\n            <br />\r\n            <div class=\"form-group\">\r\n              <label>Choose Role</label\r\n              ><select v-model=\"roleID\" class=\"form-select\">\r\n                <option value=\"student\">Student</option>\r\n                <option value=\"support agent\">Support Agent</option>\r\n                <option value=\"admin\">Admin</option>\r\n                <option value=\"manager\">Manager</option>\r\n              </select>\r\n            </div>\r\n            <button class=\"btn btn-primary\" type=\"submit\">Submit</button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <hr />\r\n    <div class=\"container\">\r\n      <p>\r\n        <button\r\n          class=\"btn btn-primary heading\"\r\n          type=\"button\"\r\n          data-bs-toggle=\"collapse\"\r\n          data-bs-target=\"#collapseExample2\"\r\n          aria-expanded=\"false\"\r\n          aria-controls=\"collapseExample\"\r\n        >\r\n          ADD MULTIPLE USERS BY CSV FILE\r\n        </button>\r\n      </p>\r\n      <div class=\"collapse\" id=\"collapseExample2\">\r\n        <div class=\"card card-body\">\r\n          <label> Please upload a CSV file if you wish to import data</label\r\n          ><br />\r\n          <div class=\"form-group\">\r\n            <input\r\n              class=\"btn btn-lg\"\r\n              ref=\"file\"\r\n              id=\"file\"\r\n              type=\"file\"\r\n              accept=\".csv\"\r\n              v-on:change=\"onUpload($event)\"\r\n            />\r\n          </div>\r\n          <div class=\"col-md-4\">\r\n            <button class=\"btn btn-primary\" @click=\"fileSubmission\">\r\n              Submit\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <hr />\r\n    <div class=\"container\">\r\n      <p>\r\n        <button\r\n          class=\"btn btn-primary heading\"\r\n          type=\"button\"\r\n          data-bs-toggle=\"collapse\"\r\n          data-bs-target=\"#collapseExample3\"\r\n          aria-expanded=\"false\"\r\n          aria-controls=\"collapseExample\"\r\n        >\r\n          DELETE USER BY USERNAME\r\n        </button>\r\n      </p>\r\n      <div class=\"collapse\" id=\"collapseExample3\">\r\n        <div class=\"card card-body\">\r\n          <div class=\"form-group\">\r\n            <label>Enter the username you wish to delete</label\r\n            ><input\r\n              type=\"text\"\r\n              class=\"form-control\"\r\n              v-model=\"username\"\r\n              required\r\n            />\r\n          </div>\r\n          <div class=\"col-md-4\">\r\n            <button class=\"btn btn-primary\" type=\"submit\" @click=\"onDelete\">\r\n              Delete\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n//import router from '@/router';\r\nimport axios from 'axios';\r\nexport default {\r\n  name: 'ManageUsersComponent',\r\n  data() {\r\n    return {\r\n      emailID: '',\r\n      roleID: '',\r\n      myFile: '',\r\n      username: '',\r\n      usernames: [],\r\n      user_id: null,\r\n    };\r\n  },\r\n  methods: {\r\n    async onDelete(x) {\r\n      x.preventDefault();\r\n      await axios\r\n        .get('/api/user')\r\n        .then((res) => {\r\n          let data = res.data.data;\r\n          this.usernames = data.map(({ user_name }) => user_name);\r\n          if (!this.usernames.includes(this.username)) {\r\n            alert(\"This username doesn't exist or is an admin/manager.\");\r\n            this.$router.go();\r\n          } else {\r\n            data.forEach((x) => {\r\n              if (x.user_name == this.username) {\r\n                this.user_id = x.user_id;\r\n                console.log(this.user_id);\r\n              }\r\n            });\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n      await axios\r\n        .delete(`/api/user/${this.user_id}`)\r\n        .then(() => {\r\n          alert('User deleted successfully');\r\n          this.$router.go();\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    async addUser(x) {\r\n      // console.log(this.response)\r\n      x.preventDefault();\r\n      let thing = null;\r\n      if (this.roleID.toLowerCase() == 'student') {\r\n        thing = 1;\r\n      } else if (this.roleID.toLowerCase() == 'admin') {\r\n        thing = 3;\r\n      } else if (this.roleID.toLowerCase() == 'support agent') {\r\n        thing = 2;\r\n      } else if (this.roleID.toLowerCase() == 'manager') {\r\n        thing = 4;\r\n      } else {\r\n        alert(\r\n          'Please choose role amongst student/admin/manager/support agent!'\r\n        );\r\n        this.roleID = '';\r\n      }\r\n      if (this.roleID == '') {\r\n        location.reload();\r\n      } else {\r\n        console.log(this.emailID);\r\n        console.log(thing);\r\n        let c = this.emailID;\r\n        var data = { email_id: c, role_id: thing, username: data.username };\r\n        console.log(c);\r\n        data = JSON.stringify(data);\r\n        console.log('Data is :');\r\n        console.log(data);\r\n        await axios\r\n          .post('/api/user', {\r\n            data,\r\n          })\r\n          .then((res) => {\r\n            alert('User has been successfully added.');\r\n            //this.$router.go();\r\n            console.log(res);\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n      }\r\n    },\r\n    onUpload() {\r\n      this.myFile = this.$refs.file.files[0];\r\n    },\r\n    fileSubmission() {\r\n      let formData = new FormData();\r\n      console.log(this.myFile);\r\n      formData.append('file', this.myFile);\r\n\r\n      let authtoken = localStorage.getItem('token');\r\n      fetch('http://localhost:5000/api/importUsers', {\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        cache: 'no-cache',\r\n        credentials: 'omit',\r\n        headers: {\r\n          secret_authtoken: authtoken,\r\n          //'Content-Type': \"multipart/form-data\",\r\n        },\r\n        redirect: 'follow',\r\n        referrerPolicy: 'no-referrer',\r\n        body: formData,\r\n      })\r\n        .then(() => {\r\n          alert(\r\n            'User addition request has been received. You will get notified via email on the status.'\r\n          ); /*location.reload()*/\r\n        })\r\n        .catch((e) => console.log(e));\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.topic-container {\r\n  margin: 33px 63px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 1.5rem;\r\n}\r\n\r\n.heading {\r\n  background-color: white;\r\n  color: black;\r\n  font-size: 25px;\r\n}\r\n\r\n.heading:hover {\r\n  background-color: #f1f1f1;\r\n  color: black;\r\n  font-size: 20px;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}